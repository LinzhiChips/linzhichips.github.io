fw-test-20221012-0128.tar

	Dual-mining:

	- Experimental support for ETC+ZIL dual-mining. For details, see
	  https://github.com/LinzhiChips/doc/blob/master/guide-zil.txt

	Pools:

	- 2Miners.com no longer supports Expanse. Added a template for
	  ExpansePool instead.

	Command-line tools:

	- "rr" to list reports, show files in them, and print their content.

	Problem reporting:

	- Reports now also include the console log.

	- In Power > Dump, the first line (with the date) is now also shown if
	  using the "Status" filter.

	Communication with pool:

	- If using the EtherProxy protocol (stratum0), specifying a password
	  had no effect.

	Bug fixes:

	- SUB_EXTRANONCE was ignored. This bug was introduced in
	  fw-test-20220801-1821.

	- "Harmless" CML errors were not ignored if any board had IGNORE set to
	  "ignore" or "ban".

	- If a mining daemon was in the process of loading a DAG, and then was
	  stopped (e.g., by powering off a slot), then the board state remained
	  at the "loading" value, and caused the DAG daemon to hold, possibly
	  indefinitely.

	  The DAG daemon now listens to the mining daemon's "last will" topic,
	  and only considers information from slots with an active mining
	  daemon.

	- A miner could fail to reboot if some resources were "stuck" in the
	  kernel. In this case, the Web UI would refresh continuously,
	  indicating "Rebooting".

	  We now force a hardware reboot without waiting for "stuck" resources
	  if the "clean" reboot attempt was unsuccessful.

fw-test-20220924-1608.tar

	Pools:

	- Removed all ETH pool templates from Configuration > Pool.

	Web UI:

	- Show machine name in title bar.

	On/off control:

	- Avoid misleading "OFF" indications:
	  In order for a miner to show status OFF, not only does a power switch
	  have to be "off", but - if it is a per-slot switch - the
	  corresponding slot must have a board present and must not be ignored.
	  This applies both to the status display in the Web UI and the crew.

	- On the status page, slot status is now "OFF" only if disabled by a
	  power switch, and "OFF (OPS)" if disabled by the ops switch.

	- The status of the ops switch is now shared with the crew. If a miner
	  is "off" because of the ops switch, this is indicated in
	  Crew > Miners as "ops". (If it is powered off with the main/slot
	  switch, the indication is "OFF".)

	Fan control:

	- Changes to Configuration > Controller > General > FAN_PROFILE are now
	  applied immediately.

	- MQTT topic /fan/profile now only reports the current profile but no
	  longer changes it. New /fan/profile-set changes the current profile,
	  overriding configuration.

	- Graph on Temperature > Control now has labels and a grid.

	- Input field on Temperature > Control now shows current profile.
	  Previous default value is now shown as "placeholder" (in grey).
	  Furthermore, commas are now used as separators, instead of spaces,
	  matching the syntax of
	  Configuration > Controller > General > FAN_PROFILE. (Note that the
	  messages on /fan/profile and /fan/profile-set still use spaces as
	  separators.)

	Diagnostics:

	- The dmesg diagnostic is now at Diagnostics > Logs > dmesg (was at
	  Diagnostics > dmesg)

	- New Diagnostics > Logs > Console with the latest (non-kernel) console
	  messages. (This shows messages generated during the boot process and
	  by daemons that are not launched by kunai - e.g., kunai itself.)

	- In Diagnostics > MBIST > Test: only show "Note: here we count
	  defective blocks. UI counts nodes." only if the MBIST run completed.

	Bug fixes:

	- When mining daemons are mining, the Web UI shows "Mining" next to the
	  per-slot progress bars. This indication is cleared when the mining
	  daemon exits (e.g., when powering down). However, the (now false)
	  indication would come back if reloading the page.

	  This is caused by the stale /mine/SLOT/state being retained, but
	  /mine/reset being designed in a way that makes it unsuitable for
	  retaining. This is now fixed, with new /mine/running and
	  /mine/SLOT/running replacing former /mine/reset. For details, see
	  https://github.com/LinzhiChips/doc/blob/master/MQTT.txt

	- With all slots empty/ignored/powered down, a miner would sometimes
	  indicate "POOL" in the crew, even though not being connected to a
	  pool is perfectly normal in this situation.

	- Fan profiles that end below 100% are continued with a step to 100%
	  at the last point. This was not shown correctly in
	  Temperature > Control.

	- Diagnostics > ECB > Bits #3 ran the test on bus #1, not #3.

	- When the list of pool destinations had entries with the same URI,
	  which an unexpected but valid configuration, the failover could fail,
	  and cycle between these duplicate entries, thus never selecting a
	  non-failing entry. The mining daemon now ignores duplicate entries.

	Known bug (may have existed for a while):

	- When powering down a slot with any of the switches in Power > On/Off,
	  killing the mining daemon (prior to cutting power) may fail. In this
	  case, the slot will be marked as "OFF", but remains operational.
	  Cycling the power switches has no effect while the slot is in this
	  abnormal state.

	  The reason why the killing fails is still under investigation.
	  As a work-around, manually killing the mining daemon(s)
	  (System > Daemons) will restore normal operation.

fw-rd-20220904-1754.tar

	Pools:

	- Added a template for NiceHash (ETChash):
	  https://www.nicehash.com/blog/post/etchash-is-now-available-at-nicehash

	Web UI:

	- Banners are now generated by coord, not the boot process. Changing
	  them has immediate effect, without requiring a reboot.

	- The miner-wide "OFF" status (any master or slot switch is "off") is
	  also shown in the status area and the document title, not only in the
	  crew.

	- Speed up UI initialization by generating complex Diagnostics > MBIST
	  pages only if accessed.

	Diagnostics:

	- While a diagnostic is running, MQTT topic /diag/running is set to its
	  name. (Else, it is set to "-".)

	- While a diagnostic is running, diagnostics buttons are disabled on
	  all browsers connected to the miner, not just the one from which the
	  diagnostics were started.

	Crew:

	- Crew > Setup > IP to URL mapping now shows the correct example URL
	  (with https: if using HTTPS) for Default.

	- Removed obsolete Werner-Tunnels from Crew > Setup > IP to URL
	  mapping.

	- If an already existing IP address is added with another ID (MAC
	  address), mark the address of the new entry.

	Bug fix:

	- If a hashboard reported no total power input, pwrpolld sent an empty
	  string on /power/SLOT/total_input instead of a number (e.g., zero).

fw-test-20220801-1821.tar

	Temperature monitoring:

	- Raised the default value for the thermal warning threshold from 85 C
	  to 90 C.

	- The thermal shutdown threshold can now be configured in
	  Configuration > Slot N > General > TSHUT. The default is 95 C, which
	  was the fixed limit so far, the maximum is 100 C.

	- The thermal shutdown temperature is now reported on MQTT topic
	  /temp/SLOT/shut (for each slot) instead of /temp/limit (for the whole
	  miner).

	- The key on Temperature > Boards now also includes the colors for
	  unresponsive, skipped, and overdue channels.

	Network monitoring:

	- card-troubled now also detects Ethernet link up/down transitions, and
	  reports them on MQTT topic /sys/ether/up.

	- coord reads /sys/ether/up, detects bouncing links (more than 10
	  up/down transitions in less than 20 minutes), and reports them on
	  /sys/ether/bounce. The bounce indication auto-clears after the link
	  has been stable for two minutes.

	- The Web UI indicates link bounces as "ETHER BOUNCE". The crew shares
	  this information as well, and it is indicated as "ETHER".

	- When the Ethernet link is down, the RGB LED blinks yellow.

	Diagnostics:

	- ASIC memory test (MBIST, Memory Built-In Self Test) data, which is
	  cached on the uSD card and used by mined, is now shown in
	  Diagnostics > MBIST > Current.

	- An ASIC memory test can be started from Diagnostics > MBIST > Test.
	  The new MBIST data can then replace the one cached on the uSD card.

	Mining:

	- Experimental Configuration > Controller > Mining > DYNAMIC_MEMORY
	  to enable dynamic memory allocation, to skip nodes with uncorrectable
	  memory defects. (Default: use all nodes and pretend there are no
	  uncorrectable defects.)

	On/off control:

	- Power > On/Off now has an operations-defined switch in series with
	  the master on/off switch. The ops switch is intended for use with
	  site-specific sensors and policy controllers. For details, see
	  https://github.com/LinzhiChips/doc/blob/master/guide-on-off-ops.txt

	Status display:

	- Make message priorities on the Web UI match those of the crew: DCDC
	  SHUTDOWN gets higher priority than THERMAL SHUTDOWN, and SILENT gets
	  higher priority than BOOT.

	Bug fix:

	- In firmware fw-rd-20220706-2248, the title on Web UI pages only said
	  "Linzhi" instead of "Linzhi Phoenix". /sys/machine-type (MQTT) was
	  also wrong.

fw-rd-20220706-2248.tar

	System status:

	- The size of the controller RAM is shown on System > R&D. This can be
	  used to check whether the boot loader has been updated to a version
	  that supports 1 GB.

	Pool interaction:

	- Destinations/pool URIs can now also use the board name, with
	  ${boardname}. This allows seeing individual boards at the pool if
	  SEPARATE_MINED is set. The wizard in Configuration > Pool supports
	  using the board name as rig name.

	Bug fixes:

	- Diagnostics > ECB > Clock reported the result for ECB #0 also for #1,
	  and the result for #2 also for #3.

	- If the first slot was empty, ignored, etc., Diagnostics > ECB > Clock
	  would say it tested the second slot, but in reality used the
	  (probably unresponsive) first slot.

	- mDNS did not publish the machine name.

	- The temperature reporting daemon (trepd) tried to poll absent boards,
	  producing false errors in System > Problems > I2C bus reset count.
	  This bug was introduced in fw-test-20220117-2339

	- Failure to read a voltage regulator register could lead to a data
	  formatting error inside pwrpolld, which could in turn corrupt the
	  value reported in /power/SLOT/total_input.

	- Voltage and current reported by the voltage regulators can be
	  negative, but were treated as unsigned numbers. This caused stray
	  indications on Power > Telemetry of 65.553 V, or similar.

	- With SEPARATE_MINED set, booting after a uSD card change or hashboard
	  swap could result in a "Boot failure" and failure to mine on one of
	  the boards.

fw-rd-20220203-0007.tar

	Bug fix:

	- Increase maximum ETC epoch from 240/480 (240th DAG size increase,
	  480th DAG content change) to 500/1000. Epoch 240/480 was reached on
	  2022-02-02 UTC.

fw-test-20220117-2339.tar

	Note: this update only has a *-full.tar version, since it makes several
	changes to the early boot process. When upgrading, the upgrade needs to
	be performed twice, since the upgrade process itself needs to be
	updated for some of the changes.

	Firmware updates:

	- If the firmware tar contains a boot loader (i.e., if this is a
	  *-full version), the boot loader is updated.

	Base system upgrade:

	- Upgrade buildroot from 2020.05 to 2021.02. The update was needed
	  because the build process failed on recent Ubuntu versions.

	- Upgrade kernel from 5.6.0 to 5.10.89. buildroot 2021.02 needs a newer
	  kernel. 5.10 is the first kernel that is modern enough, and it also
	  happens to be long-term supported until December 2026.

	- Use all the RAM of the controller (1 GB), instead of only half of it.

	Serial console:

	- The serial console is now enabled when U-Boot starts, not later in
	  the boot process. This shows all the progress messages from U-Boot
	  and allows interacting with the boot loader.

	Problem reporting:

	- If enabled in Configuration > Controller > Reports > REPORT_OOM,
	  miners try to generate a report when the kernel signals an
	  out-of-memory condition.

	Power monitoring:

	- Power > Telemetry now shows rail names.

	I2C:

	- Added LB1002 (development board) I2C layout. This changes power
	  setting (setpwr) and monitoring (pwrpolld, Power > Telemetry),
	  temperature monitoring (Temperature > Boards, nomelt and trepd), I2C
	  diagnostics (Diagnostics > I2C), I2C monitoring (i2c-troubled,
	  System > Problems), and power dumps (dcdc-dump).

	System status:

	- If the FPGA bitstream (PL) is changed, /sys/pl-git and /sys/pl-t, and
	  thus also the PL data in System > Firmware are updated.

	Bug fix:

	- All non-zero values of
	  Configuration > Controller > General > POWER_POLL_INTERVAL were
	  interpreted as 5 seconds.


fw-rd-20211223-1354.tar

	Note: we noticed that there are still memory problems that can make a
	miner fail to accept a firmware update (if updating via the Web UI or
	MQTT - updating the uSD card directly, with a PC, always works).

	We have updated
	https://github.com/LinzhiChips/doc/blob/master/guide-no-memory.txt
	for the new symptoms, prevention, and remedies. We strongly recommend
	rebooting miners shortly before the firmware update, to prevent
	out-of-memory problems from occurring.

	Web UI:

	- If editing a note in Crew > Miners, incoming updates caused the
	  browser to stall for a few seconds. While editing, we now process
	  only the most important fields, and stop updating the miner list.

	- The maximum number of destinations in Configuration > Pool has been
	  raised from 10 to 20.

	Tuning:

	- The logic voltage of hashboards can now be set in the range
          800-900 mV. Previously, the range was 850-950 mV. The default remains
	  at 850 mV. The setting is at:
	  Configuration > Slot N > Tuning > VDD (reboot required).
	  We expect stable operation to be possible at 820 mV on most boards.

	Diagnostics:

	- Diagnostics > Fingerprints: retrieves patterns that can be used to
	  identify chips and hashboards. See also
	  https://github.com/LinzhiChips/doc/blob/master/guide-fingerprinting.txt

	- Diagnostics > EEPROM: show space utilization of configuration
	  EEPROMs.

	Bug fixes:

	- Configuration > Access showed "true" instead of the user name in
	  "Change password of".

	- Some buttons on the pages of Diagnostics were not disabled (greyed
	  out) while diagnostics were running.

	- When booting, user space did not write diagnostics to the serial
	  console, nor did it properly start a shell. As a result, there were a
	  few (harmless) complaints in the boot process that should have been
	  avoided.

	  The incorrect handling of the console also prevented utmp from being
	  set up and used, making "w" (in shell sessions) fail silently.

	- After moving (drag and drop) a destination in Configuration > Pool,
	  the URI displayed changed to a number (the row index). This was only
	  a display error, the data stored in the EEPROM and used by the mining
	  daemon was not affected.

	  Note: drag and drop seems to be broken in Chrome 98.0.4710.4, with
	  none of the drag and drop examples on Stack Exchange working either.
	  Firefox 94.0 works fine.

	- If the (non-separated) mining daemon reset, this could switch the UI
	  to show system statistics as if the miner was operating with separate
	  mineds.

	- The MQTT parameter max_queued_messages had a default value of 100,
	  not the 1000 it normally has. This caused message loss, which in turn
	  produced subtle and hard to track issues. We now use a limit of 1000
	  messages.

	- The login status (relevant mainly in SECURE mode) was not always
	  updated when logging in/connecting. The authentication system, being
	  late among the subscriptions, was also affected by the MQTT message
	  queue limit.


fw-rd-20211004-0038.tar

	Bug fix:

	- dagd now suspends DAG operations while a mining daemon is loading a
	  DAG. This can speed up DAG uploads after a reboot by about 40%.


fw-test-20211001-0239.tar

	Bug fixes:

	- The 2nd byte of the numerical address in /mine/pool/state was
	  sometimes off by one bit position, which could be observed mainly by
	  slightly wrong pool addresses being shown in the crew. (This is
	  related to a similar bug fixed in fw-rd-20210223-2105.)

	- dagd now listens to (new) /mine/SLOT/epoch

	- crewd now listens to /mine/SLOT/epoch, /mine/SLOT/pool/state,
	  /mine/SLOT/pool/statistics

	- coord now listens to /mine/SLOT/pool/statistics

	- Fixed a potential buffer overflow and an end-of-list overrun in dagd.

	Diagnostics:

	- Diagnostics > ECB > Bits #bus test if (and how) bit patterns get
	  altered on the ECB, e.g., because of cable/connector defects.

	Known bug:

	- dagd still tries to use the long gone /mine/mined-state topic, which
	  prevents holding DAG generation while mined loads a DAG, and can lead
	  to (slightly) increased load times. (Fixed in fw-rd-20211004-0038.)


fw-test-20210915-0039.tar

	Note: this is an experimental update that includes improvements but
	also some regressions. Please read the description of changes before
	deciding whether to try it.

	Separate mining daemons:

	What follows are long overdue improvements, mainly to the main status
	page, when using separate mining daemons. The overall result should be
	that indications no longer jump between each daemon's individual view,
	but are either combined or shown side by side.

	These changes also implied some rearranging of MQTT messages.

	Note: these changes may still change. Also, some less important
	displays, e.g., System > Quality, will still "jump". Furthermore, crew
	data is still based on the old interface (/mine/epoch,
	/mine/pool/state, and /mine/pool/statistics) and the columns "Coin",
	"Epoch", "Pool address", "Accepted", "Stale %", and "Reject %", may
	thus be less correct than they were before.

	- /mine/reset can now indicate which slot is being reset. The Web UI
	  then only resets the respective parameter set.

	- A mining daemon operating a single slot uses /mine/SLOT/pool/state
	  instead of /mine/pool/state. If mining demons connect to different
	  pools (or different endpoints of the same pool), both are shown in
	  the Web UI.

	- A mining daemon operating a single slot uses /mine/SLOT/epoch instead
	  of /mine/epoch. If mining daemons disagree (which is possible but
	  probably not intended), both coins and epochs are shown in the Web
	  UI.

	- A mining daemon operating a single slot uses
	  /mine/SLOT/pool/statistics instead of /mine/pool/statistics, and
	  /mine/SLOT/net-perf is used instead of /mine/net-perf. The main
	  status display rearranges for separate mining daemons and shows both
	  data sets. Furthermore, it shows the combined pool hash rate.

	Bug fixes:

	- Properly fix ignoring "harmless" CML errors.


fw-rd-20210909-1344.tar

	Bug fixes:

	- Starting with firmware fw-rd-20210828-0106, several configuration
	  variables (including per-slot variables used for mining) were not
	  used when daemons started, resulting in mis-configuration.

	  As work-around, a mining daemon restart (Stop/Start) would result in
	  the configuration to be used as expected.

	- Starting with firmware fw-test-20210728-0952, "harmless" CML errors
	  (i.e.,  indicating no other abnormal condition) were no longer
	  ignored. (Note: this attempted fix wasn't successful.)


fw-rd-20210908-1829.tar

	Release:

	- This is the combination of fw-test-20210905-1749 and
	  fw-test-20210907-1735, plus the changes below.

	Configuration:

	- Limit Configuration > Controller > Mining > RESERVED_SPACE to
	  non-zero multiples of 1 GB. (configd also accepts multiples of 1 MB.)

	Crew:

	- Updates of the list on Crew > Miners are now stopped while a
	  selection is in progress. This prevents crew updates from disrupting
	  selections.

	
fw-test-20210907-1735.tar

	Configuration:

	- The amount of uSD card space reserved for other things like DAGs
	  (i.e., the firmware, checksums, reports, etc.), can now be changed
	  from the default of 6 GB by setting
	  Configuration > Controller > Mining > RESERVED_SPACE.
	  (To make the change effective, restart dagd or reboot.)

	Diagnostics:

	- Diagnostics > ECB > Clock toggles the ECB bus clock and monitors its
	  propagation.


fw-test-20210905-1749.tar

	Diagnostics:

	- Diagnostics > Logic clock measures the reference clock and the PLL
	  clock at each die.

	- Diagnostics > SerDes clock measures the SerDes transmission rate
	  (open-loop) at each quad.


fw-rd-20210828-0106.tar

	Configuration:

	- If a board is set to IGNORE=ban, this now also stops the temperature
	  reporting daemon (trep) from polling the temperature sensors.

	- If the controller EEPROM contains SLOTn_IGNORE=ban (with n being 0 or
	  1), this suppresses reading the EEPROM of the respective
	  hashboard(s).

	  This is useful for working around a somethat tricky (but rare) fault.
	  For details, see
	  https://github.com/LinzhiChips/doc/blob/master/guide-i2c-lockout.txt

	- New per-slot configuration variable GEN_RATIO (1 to 100%) to lower
	  the task generation ratio (to reduce power consumption).

	- Per-slot variables FORCE, SERDES_RATE, SKIP_DIES, and SERDES_TRIM now
	  only need cycling of mined (System > Daemons > mined "Stop", then
	  "Start") for changes to become effective, no reboot.

	- Controller-level variable SUB_EXTRANONCE now only needs cycling of
	  mined for changes to become effective.

	User interface:

	- New sections System > R&D > Hardware details and ... > Zombie-mining,
	  showing the number of active dies, communication channels, clock
	  speeds, etc.

	- In Crew > Miners, add columns "Dies", "Bad channels",
	  "SerDes (Gbps)", and "Task interval".

	Bug fix:

	- Fixed two memory leaks in mined. (Caused stable miners to run out of
	  memory after a few days of operation.)


fw-rd-20210808-0031.tar

	Release:

	- This is the combination of fw-test-20210711-1936,
	  fw-test-20210728-0952, fw-test-20210729-0536, and
	  fw-test-20210806-1024, plus the change below.

	Crew:

	- Consistently use -1 if the checksum files version is unknown, for the
	  crew JSON API, /crew/update, and the JSON export on Crew > Miners.

	Known bug:

	- The miner may run out of memory when trying to apply a firmware
	  update via MQTT. The symptoms are that the miner does not react to
	  the MQTT message, and does not reboot.

	  Work-around: go to System > Daemons and kill mined and dagd, then
	  retry the update.


fw-test-20210806-1024.tar

	Problem reporting:

	- I2C resets of DCDC regulators are now reported on
	  System > Problems > I2C bus reset count

	- If repeated I2C resets don't resolve a DCDC regulator problem, this
	  now causes an I2C warning.

	- Power > Dump now also shows decoded STATUS_CML if the "Status" filter
	  is selected.

	Diagnostics:

	- Diagnostics > dmesg shows kernel messages, e.g., to diagnose card
	  problems.

	- Diagnostics > I2C runs I2C bus scans (i2cdetect).

	Configuration:

	- Configuration > Slot n > General > IGNORE now has the option to "ban"
	  the board. This not only prevents mining but suppressed all
	  monitoring and processing of alerts (thermal shutdown, etc.)

	  If a board is "banned", the "IGNORE" on the status page changes to
	  "BANNED".

	- The threshold for input undervoltage faults can now be set (raised
	  only) in Configuration > Slot n > Tuning > VIN_UV (reboot required).

	Crew:

	- The version of the checksum files is shared with the crew. (Column
	  "Checksums", "csum_version" in JSON.)

	Bug fix:

	- CREW_PORT didn't change the listening port for the multicast group.

	Known bugs:

	- If there is an uncleared fault and a reboot is commanded, the "Clear"
	  button will appear under the "Rebooting" indication (if clicked, it
	  tries to clear the fault, which the reboot will clear anyway, and
	  doesn't affect the reset.)

	- If mined closes and re-opens a pool connection, it may not clear the
	  pending mining job, and crash if a result arrives from the ASICs.
	  Mined automatically restarts after such a crash.


fw-test-20210729-0536.tar

	Crew:

	- Configuration option Configuration > Controller > Crew > CREW_PORT to
	  set the UDP port used for peer-to-peer communication. (Reboot or
	  crewd restart required.)

	- Configuration option Configuration > Controller > Crew >
	  CREW_MCAST_ADDR to set the multicast group address used for
	  peer-to-peer communication. (Reboot or crewd restart required.)

	- Also changes to configuration options CREW, CREW_API, and
	  CREW_API_PORT can now be applied by just restarting crewd, without a
	  reboot.

	Problem reporting:

	- A thermal, DCDC, and I2C shutdown now indicates in the title of the
	  report which slot(s) triggered it.

	Temperature monitoring:

	- Skipped channels (SKIP_TCHAN) are now shown with a white background
	  in Temperature > Boards.

	- Unlikely temperatures (<= 10 C) are shown with a grey background,
	  instead of the "icy blue" we use up to 50 C.

	Bug fixes:

	- MQTT topic /temp/+/skip wasn't retained. This broke the indication of
	  skipped sensor channels in Temperature > Boards.

	- SKIP_TCHAN failed to turn off most of the channels it was supposed to
	  skip.


fw-test-20210728-0952.tar

	Web UI:

	- Major HTML cleanup, aided by "tidy". Visible changes should be
	  minimal (the most noticeable change should be that
	  Temperature > Boards now uses a bold font).

	- The URL parameter mqtt_debug now accepts an optional value. This
	  value, if present, is a string that any MQTT message must contain
	  either in its topic or payload to be shown on the console.

	- Configuration > Slot N now has sections instead of one long list of
	  options.

	General features:

	- mined reports the number of extranonce bits provided by the pool on
	  /mine/pool/extranonce. The extranonce bits are shown in the UI on
	  System > R&D > Extranonce.
	  This is available on MQTT topic /mine/pool/extranonce

	- The version number of the checksum files is now shown in
	  System > Firmware > Checksums version. If no version information is
	  available, a dash (-) is shown.
	  The corresponding MQTT topic is /fw/checksums-version

	- If installing new checksum files fails, the version information is
	  deleted. This will cause the installation to be retried when
	  installing an fw-*-full.tar, even if the version is the same.

	Infrastructure:

	- Recovered files ("lost cluster chains") on the uSD card are now
	  automatically deleted at boot time. This can be avoided by setting
	  Configuration > Controller > General > KEEP_FSCK

	Ubiq:

	- Pool templates for MaxHash, SoloPool, Ubiqpool.

	- Ubiq has very long block times, which could cause the miner to run
	  out of nonce space to search, and lose an estimated 2% of hash rate.
	  The nonce space is now increased by one bit in some cases.

	  For further details, see
	  https://github.com/LinzhiChips/doc/blob/master/ubiq-blocktime.txt

	Tuning:

	- Hashboard voltages can now be adjusted in
	  Configuration > Slot N > Tuning (reboot required).

	Bug fix:

	- When loading the Web interface over a slow link, elements from
	  various tabs were briefly shown. They are now suppressed.


fw-test-20210711-1936.tar

	Zombie-mining:

	- Support zombie-mining if DAG size exceeds available memory. See
	  https://github.com/LinzhiChips/doc/blob/master/zombie-mining.pdf

	- Configuration variable Configuration > Slot N > ZOMBIE_COMPENSATION
	  to adjust speed.

	- Updated checksums (only in fw-*-full.tar !) to include Ethash epochs
	  up to 479 (approximate end date 2022-03).

	Ubiq:

	- Support for Ubiq (UBQ), using the Ubiqhash algorithm, an Ethash
	  derivative. Contributed by Luke Williams (@iquidus).

	- Pool template (for Crazypool) in Configuration > Pool > UBQ

	- Updated checksums (only in fw-*-full.tar !) to include Ubqhash epochs
	  22 to 99 (approximate end date 2038-02).

	Web UI:

	- Reduced top margin in the Temperature > Control diagram, so that 100%
	  PWM no longer looks like 90%.

	Instrumentation:

	- Enabled nc (netcat)

	Bug fixes:

	- Updates of checksum files were not applied when updating the firmware
	  via Web / MQTT, even though the rest of the update went fine. Since
	  this firmware update is the first that contains new checksum files,
	  please update as follows:

	  - use the fw-...-full.tar file, version fw-test-20210710 or later.
	  - either:
	    - update by extracting the content of the tar file to the top-level
	      directory of the uSD card,
	  - or:
	    - install the update via Web / MQTT and wait for the miner to
	      reboot, then
	    - install the same update via Web / MQTT a second time.
	    The first update will install a corrected version of the firmware
	    update daemon, which will then be able to extract the archive with
	    the updates the checksum files.

	- Reports did not include /temp/shutdown in messages.txt


fw-rd-20210629-0704.tar

	Web UI:

	- Configuration > Controller now has tabs for distinct parts of the
	  configuration, instead of putting everything on one long list.

	Temperature monitoring:

	- If the temperature sensor channels to both dies in the same package
	  fail to report, this is indicated in /temp/+/overdue. This causes:
	  - a "TSENSE FAULT" status indication,
	  - on Temperature > Boards, the affected die(s) to be marked with a
	    dark grey background,
	  - a TSENSE indication in the crew,
	  - the fan RPM to be set to 100%, and
	  - the RGB LED to turn yellow (unless there are more severe issues to
	    indicate).
	  The condition clears automatically if/when new temperature readings
	  arrive.

	- Temperature reporting by trepd could sometimes (rarely) freeze,
	  causing Temperature > Charts to just stop updating. Applied a
	  work-around for the likely cause.

	  If the workaround should fail to work, the freeze would now be
	  indicated as a TSENSE fault affecting all channels.

	Power monitoring:

	- Periodic updates of Power > Telemetry can be enabled by setting
	  POWER_POLL_INTERVAL to a non-zero value (reboot required).
	  (Note: this is implemented as the wait time between polls. Since each
	  poll takes several seconds, the actual interval is longer.)

	- Each time Power > Telemetry updates, total power to each hashboard
	  (excluding fan and controller power) is reported under the MQTT topic
	  /power/0/total_input and shared with the crew.

	On/off control (experimental):

	- Power to the hashboards is now controlled by the coordination daemon
	  (coord). The mined-launch scripts no longer enable power to the
	  boards, but depend on coord to do this for them.

	- Power to the hashboards can now be switched on and off. There is one
	  switch per slot, and a master switch for both slots. If using one
	  mining daemon for both boards (SEPARATE_MINED not set), then
	  switching power to any slot on or off causes a restart of mined.

	  By default, all switches are "on" after booting, and don't retain
	  their state across reboots. This can be changed by setting
	  SWITCHES_ON_BOOT (see below).

	  The switches can be found in Power > On/off. Any "off" state is also
	  shown on the status page. If any switch is "off", this is indicated
	  in the crew flags as "OFF".

	  On/off control starts/stops mined and enables/cuts power to the
	  board. MQTT control is through /power/on/master and
	  /power/on/slotN.

	  Since turning a board off removes all power from the ASICs, a full
	  reload of firmware and DAG is performed after turning it on again.

	- The setting of the power switches at boot time can be controlled by
	  setting Configuration > Controller > General > SWITCHES_ON_BOOT.
	  Default is "Power on".

	- There are now two choices for restoring power and restarting mining
	  after a shutdown:

	  - if Configuration > Controller > General > TRIP_MASTER is not set
	    (default), clearing the shutdown restores power (unless any of the
	    power switches have been turned off)

	  - if TRIP_MASTER is set, the master switch acts like a circuit
	    breaker: is turned off when a shutdown occurs, and must be
	    explicitly turned on after clearing the shutdown.

	  No reboot is needed for changes of TRIP_MASTER to become effective.
	  Further details on resuming after a shutdown can be found in
	  https://github.com/LinzhiChips/doc/blob/master/shutdown-resume.txt

	Instrumentation:

	- New shell command "psreset" to force a system reset if even
	  /sbin/reboot -f won't save the day, e.g., when the kernel is
	  partially crashed.

	Bug fixes:

	- Clearing a fault ("Clear" button, MQTT /sys/clear-shutdown) did not
	  clear I2C warnings.

	- Configuration > Controller > FAN_PROFILE accepted syntactically
	  invalid profiles (in particular: using spaces instead of commas,
	  which would then be silently rejected by configd.)

	- When running under kunai, daemons configd, reportd, and statsd used
	  buffered stdout and stderr, which often prevented diagnostics from
	  being show.


fw-rd-20210609-0326.tar

	Firmware signatures:

	- Removed the (very insecure) R&D key from the list of accepted
	  signees. The evaluation key introduced with fw-rd-20210107-0600
	  (the build date of the firmware can be found in System > Firmware)
	  remains valid.

	  This firmware is still signed with the R&D key, but the key will be
	  retired soon.

	  This means:
	  - you can upgrade to this version from any older version,
	  - after upgrading, you will not be able to downgrade to any version
	    older than fw-rd-20210107-0600.

	Problem reporting:

	(Note: a few of the items below are about downloads. If using a pop-up
	blocker, the miner may need to be whitelisted for downloads to work.
	he access immediately after whitelisting may fail.)

	- Power > Dump now has a download button.

	- System > Problems > Boot problem now has a download button.

	- All downloads (also the crew download) no longer include milliseconds
	  in the file name.

	- New reporting system: a daemon (reportd) monitors all MQTT traffic
	  and generates a ZIP file containing the last messages when requested
	  (e.g., after a shutdown). Reports are stored on the uSD card.

	  The ZIP archive contains the following files:
	  - title.txt: timestamp and description,
	  - backlog.txt: a list of report requests that were received while
	    preparing the previous report. No separate reports were generated
	    for them. This file is only added if there were such reports.
	  - messages.txt: MQTT messages, with timestamp, sequence number, and
	    retain flag (may be several per topic),
	  - dmesg.txt: kernel messages,
	  - *.log: daemon logs,
	  - trace-*.txt: stack traces from core dumps.
	  Some MQTT messages are redacted to remove sensitive content, e.g.,
	  passwords.

	  System > Reports shows the list of available reports. Reports can be
	  downloaded, deleted, and generated by user request.

	  By default, up to ten reports are stored. This number can be changed
	  in Configuration > Controller > REPORTS_MAX. Then there are too many
	  reports, old ones are deleted to make room for new ones. This can be
	  changed with REPORTS_ROTATE.

	  Note: changes of REPORTS_MAX and REPORTS_ROTATE have an immediate
	  effect - no reboot required.

	- When a segfault or abort of a mining, DAG, or crew daemon is
	  detected, a report is generated if the respective configuration
	  option is set (REPORT_MINED_CRASH, REPORT_DAGD_CRASH, or
	  REPORT_CREWD_CRASH, respectively.)

	  These options are disabled by default to prevent repeated crashes
	  from replacing all other reports.

	- In the event of a thermal shutdown, the last reported temperatures
	  and the fan state are shown on System > Snapshot. (This duplicates
	  information that can be obtained from reports as well, but is much
	  easier to access.)
	  
	- If there are reports or if one of the events below is pending, the
	  path to further information is indicated by red circles ("badges").

	  Events:
	  - Boot problem,
	  - thermal shutdown,
	  - DCDC shutdown,
	  - I2C shutdown.

	  The badges disappear when the reports are deleted and the event
	  indications are cleared.

	- Temperature > Snapshot and Power > Dump tabs are disabled if they
	  have no information to show. (They stay enabled also after the
	  condition is cleared.)

	Crew:

	- Crew-to-crew communication can be authenticated by setting a shared
	  secret (Configuration > Controller > CREW_SHARED_SECRET, no reboot
	  required).

	  If a secret is set, all outbound messages are signed and only
	  messages having the correct signature are accepted. If no secret is
	  set, all messages, signed or unsigned, are accepted.

	- The date of the latest report is shared with the crew, field "Latest
	  report" in the Web UI.

	- The tacho readings (RPM) of the fans are shared with the crew, field
	  "Fan RPM" in the Web UI.

	- The speed settings (PWM) of the fans are shared with the crew, field
          "Fan PWM" in the Web UI.

	Customization:

	- If the USER button is pressed for more than 2 seconds, coord runs the
	  script in /etc/linzhi/coord.d/user-long

	  The default script does nothing, but it can be replaced at boot time
	  by an rc script (e.g., rc.pl) on the uSD card.

	Infrastructure:

	- Configuration variables are now mirrored in files under /run/config
	  (on the miner). E.g., if a static IP address is set, it would appear
	  in /run/config/IP.

	  These files are meant to be read-only. Configuration changes still
	  have to be commanded through MQTT.

	- Some MQTT messages are now recorded in files under /run/mqtt.
	  So far, we record anything that ends in /shutdown, e.g.,
	  /temp/shutdown is recorded in /run/mqtt/temp/shutdown.

	  These files are meant to be read-only.

	Hardware tuning:

	- Per-slot variable SKIP_TCHAN to disable temperature sensor channels.
	  Changes require a reboot to become effective.

	  If a channel is skipped:
	  - it generates no thermal warnings or shutdowns,
	  - it is excluded from Temperature > Charts (graph and statistics),
	  - it is not colorized in Temperature > Boards,
	  - but the temperature it reports (if it does) is still shown,
	  - its temperature is not considered for fan speed control.
	  - its temperature is not considered for the peak temperature shared
	    with the crew.

	  SKIP_TCHAN is sent on /temp/+/skip at boot time, when nomelt picks up
	  the setting.

	Bug fixes:

	- The RGB LED stayed lit even if DARK_TIMEOUT was set. (Due to two
	  separate bugs.)

	- Various shell scripts would print stray errors under some conditions,
	  since test -a was used to guard expressions, but test -a does not
	  perform short-circuit evaluation. Now using && where -a was wrong.


fw-rd-20210513-0316.tar

	Mining:

	- Added optional support for the mining.extranonce.subscribe protocol
	  extension. Enable by setting Configuration > Controller >
	  SUB_EXTRANONCE.

	- Highly experimental mining mode in which two completely separate
	  mining daemons run, each with independent recovery and with its own
	  connection to the pool. This mode can be selected with
	  Configuration > Controller > SEPARATE_MINED

	  This mode is intended to improve overall performance with boards
	  that often reset, since it allows the "good" board to continue
	  mining while the other recovers.

	  Since each mining daemons decides individually when a failover is
	  needed, they may connect to different pools. Note that both
	  connections use the same wallet/account and rig name.

	  In this mode, the following indications and statistics flip between
	  results for individual boards, instead of showing summaries for the
	  entire miner:
	  - Status: everything in the Miner and Pool columns,
	  - Status: if one mining daemon dies (and indicates this by sending a
	    "last will" on /mine/reset), the firmware/DAG indications for the
	    other mined briefly become confused,
	  - System > Quality
	  - MQTT: /mine/dest, /mine/net-perf, /mine/pool/difficulty,
	    /mine/pool/state, /mine/pool/statistics, /mine/quality,
	    /mine/reset,
	  - in /crew/update: A, DW, PA, PP, RR, SR,
	  - in the crew display: Accepted, Pool address, Reject %, Stale %,
	    Wallet/account.

	Web UI:

	- When the miner is about to reboot, the status indication in the
	  upper right now changes to "Rebooting".

	Machine name:

	- If the new option Configuration > Controller > DHCP_NAME is set and
	  the DHCP server provides a host name, use the name from DHCP instead
	  of NAME. (This name is shown on the status page, to the crew, as a
	  suggestion for the rig name, and in the shell prompt.)

	- If a destination/pool URI contains the string "${name}", it is
	  replaced with the miner name. If the miner name changes, the pool
	  connection is closed and reopened.

	  On MQTT, /mine/dest contains the unexpanded URI, and the new
	  /mine/dest-actual contains the URI after variable expansion.

	Configuration:

	- If the list of keys in associative arrays (/config/user/DEST,
	  /config/user/USER, and /account/users) is empty, send a dash (-)
	  instead of an empty string. The latter would delete the topic, and
	  an application trying to read the (retained) list of keys could not
	  tell whether the list was empty or the response was just taking a
	  long time.

	Diagnostics:

	- Diagnostics > My IP can now also query ipify.org and icanhazip.com,
	  in case ifconfig.co is down.

	Bug fixes:

	- When rebooting, a "0" was sent on the MQTT topic /sys/shutdown
	  instead of "1".

	- If access access to the crew HTTP/JSON API was enabled, it was only
	  local, even if CREW_API was set to "remote".

	- A safeguard in place to remove implausibly high performance data
	  received from the ASICs was set to a threshold more than 500 times
	  to high, rendering the safeguard ineffective. Under the suitable
	  rare circumstances, this could cause the reported hash rate to
	  temporarily become very large.

	- The last output (typically a line or less) of processes that have
	  exited was not always available in the logs in System > Daemons.

	- If /mine/epoch lacks coin name and algorithm, dagd now uses the
	  default algorithm (ethash), instead of ignoring the epoch change.

	- Hover and selected indications only appeared on grey but not white
	  rows in the daemon table on System > Daemons.

	Known bug:

	- After receiving a new job, if a result that has been found and
	  verified before the job change was executed is submitted, this result
	  will have the new job ID, which may cause the pool to consider the
	  submission to be invalid (some pools correct this sort of mistake and
	  accept the submission regardless.)


fw-rd-20210421-1947.tar

	Configuration:

	- Controller and slot configuration now use UI elements for each
	  variable, instead of editing a (fake) configuration file.

	- At the MQTT interface, configuration items now have per-variable
	  granularity (before, all variables of an area were sent/changed at
	  once.)

	- The format in which lists (DEST and USER) are stored in the EEPROM
	  has changed. When the new firmware boots, it converts all old entries
	  to the new format. The old entries are preserved (for now), allowing
	  downgrades to older firmware versions.

	  A backup of the user area of the configuration EEPROM on the
	  controller (the only area that is modified by the conversion) is
	  stored on the uSD card in the file "cfgdb-user.old".

	  To restore the old database, run
	  cfgdb -w </data/cfgdb-user.old
	  from a shell on the miner.

	- Static IP configuration with variables IP and NETMASK now works
	  (used to be ignored). Default netmask changes from 255.255.255.0
	  to 255.255.0.0.

	- New configuration variables GW and DNS, to set the default gateway
	  and the name server(s).

	- SERDES_TRIM and SKIP_DIES can be set to "none", to override factory
	  settings (using an empty string would mean that the variable is not
	  set, and thus wouldn't have the desired effect.)

	MAC address:

	- Factory-configured items that are not normally overridden by users
	  are no longer shown on the Configuration pages. Examples of such
	  variables would be serial numbers and the MAC address.

	  The MAC address is now published on /net/mac and is displayed on the
	  front page of the Web UI, next to the controller serial number, and
 	  on the System > Network page.

	Accounts:

	- Account creation and management is now available under
	  Configuration > Account.

	  Note that most operations only work if an account has a SHA-256
	  password hash. If accounts with other types of password hash have
	  been set up, either delete them, or force a password change as
	  administrator.

	- The list of current access rights has moved from System > R&D >
	  Authentication tests > Access to Configuration > Account.

	- New MQTT hierarchy /account for account management. (The USER_*
	  variables are now hidden from users.)

	Networking:

	- MAC address, configuration source (DHCP or static/defaults), and
	  parameters obtained from DHCP are shown on the new System > Network
	  page.

	- New MQTT hierarchy /net for network status.

	Daemons:

	- System > Daemons: now shows each daemon's uptime.

	- It can be difficult to copy the content of the log window if the
	  daemon produces lots of output (e.g., mined). The log window now has
	  a download button that is easier to use.

	  (If using a pop-up blocker, the miner may need to be whitelisted for
	  the download to work. The access immediately after whitelisting may
	  fail.)

	Crew:

	- Access to the HTTP/JSON service is now controlled through the
	  variable CREW_API, and CREW_API_PORT now only provides the port
	  number.

	- The HTTP/JSON service is now disabled by default. CREW_API=local
	  enables local access, CREW_API=remote enabled network access.

	  Note: if the API was already enabled for remote access, it will be
	  disabled after the upgrade. To enable it again, set CREW_API in
	  Configuration > Controller and then reboot the miner.

	- If a PSU fails, this causes a DCDC shutdown and makes the whole
	  board inoperable. Therefore, if a DCDC shutdown is accompanied by an
	  I2C shutdown, indicate it as "PSHUT" and not as multi-causal failure
	  ("SHUT").

	Command-line tools:

	- "where" now also reports the MAC address.


fw-rd-20210317-0344.tar

	Crew:

	- crewd now has a HTTP-based JSON API. Access locally (on the miner)
	  with: curl localhost:81/miners

	  Remote access can be enabled by setting the configuration variable
	  CREW_API_PORT to the desired port number, e.g.,
	  - in Configuration > Controller, set CREW_API_PORT=81
	  - reboot with System > Firmware > Reboot
	  - then run, from any place on the network that is allowed to reach
	    the miner:
	    curl MINER:81/miners
	    (MINER is the miner's address)

	- The I2C shutdown flag is now treated like any other flag when sorting
	  by flags. Before, it was ignored.

	- Highlighting is now shared with the crew, and indicated in the Flags
	  column of Crew > Miners.

	Power shutdown, temperature warning/shutdown:

	- The corresponding MQTT messages (/power/shutdown, /temp/warning,
	  /temp/shutdown, etc.) now contain a bit mask indicating which slot(s)
	  signaled the condition.

	- The indicated slots are shown in the Web UI, and are included in
	  Power > Dump.

	Temperature:

	- The stylized boards on Temperature > Boards how have orientation
	  markers.

	Timekeeping (Network Time Protocol:

	- Use time.cloudflare.com instead of time.google.com, to avoid blocking
	  issues.

	- Remove ptbtime2.ptb.de as "fallback" server.

	- NTP could not be turned off through configuration (in Configuration >
	  Controller). Now setting NTP=off disables NTP.

	Bug fixes:

	- The short-term average ("short") in the JSON export of Crew > Miners
	  was divided to 1/100 of the real GH/s value.

	- If the "Default" mapping was selected in Crew > Setup, http URLs were
	  lacking the colon and thus didn't work.


fw-rd-20210223-2105.tar

	Web UI:

	- A user-configured banner (text) can be set on a controller and
	  hashboard basis (variable BANNER). This banner is shown at the bottom
	  of the top status bar. This can be used as the UI equivalent of
	  putting a sticker on a miner. (E.g., "Jim's machine", "Replace board
	  1", etc.)

	- Clarified description of Configuration > Pool > Templates and
	  System > R&D > Mined destination.

	Temperature:

	- The threshold for temperature warnings can now be configured on a
	  per-slot level, through the variable TWARN. This temperature is
	  published on MQTT with the topics /temp/SLOT/warn, and shown on the
	  side of the temperature charts.

	- Temperature > Boards now uses a table, shows both slots (if present),
	  matches the physical layout of the boards, and indicates temperature
	  ranges with colors.

	Power:

	- If a DCDC shutdown was triggered multiple times, both the first and
	  the latest register dump are sent on /power/dump, and shown in the	
	  UI.

	Crew:

	- The "SILENT" flag is now treated like any other flag when sorting by
	  flags. Before, it was ignored.

	- Occasionally refresh entries of silent miners. That way, they are
	  still shows if the Web UI is started or reloaded.

	- In a busy farm (> 100 miners), the high rate of crew updates could
	  overwhelm the browser, making it unresponsive. To counter this, we
	  now update the crew list at most once per second.

	Experimental:

	- Diagnostics now have "My IP", to obtain the IP address at which the
	  miner is seen by the pool. (Used by some pools for authenticating
	  configuration changes.)

	Bug fixes:

	- The 2nd byte of the pool IPv4 address in /mine/pool/state was
	  incorrectly shifted, making the address look plausible but wrong.
	  This incorrect information was also used by the crew.

	- /daemon/NAME/cycle caused the "stop" and the "run" event on
	  /daemon/NAME/time to be reported in the wrong order, leaving the UI
	  confused about the daemon's state.

	Known bug:

	- (Fixed in fw-rd-)

	  If a destination (pool) URI lacks the coin name, mined will send
	  epoch changes notifications without coin and algorithm. This in turn
	  causes dagd to reject the epoch changes, and thus fail to start
	  computing new DAGs. This eventually causes mined to run out of
	  pre-computed DAGs.

	  Work-around: specify coin name and stratum protocol, e.g.,
	  eth.stratum1://0x...
	  Coin name and the stratum protocol are automatically included in the
	  URI if using the wizard.


fw-test-20210201-1933.tar

	Experimental:

	- If set, the value of the controller configuration variable
	  NONCE_OFFSET is added to the start value of the nonce search. This
	  can be used to search ranges not starting at the low end of the
	  range. Extranonce and random padding are still applied, before
	  adding this offset.

	  A typical setting would be
	  NONCE_OFFSET=0x8000000000

	- Fan speed can now be regulated as a function of the temperature of
	  the hottest die in the miner. To set a profile, enter a
	  space-separate list of degC:duty% pairs in Temperature > Control.

	  Example: 50:30 80:100
	  This sets a duty cycle of 30% until 50 C, ramps up linearly to 100%
	  at 80 C, and stays at 100% for higher temperatures.

	  The profile can also be set through the controller configuration
	  variable FAN_PROFILE. In instead of spaces, commas are used as
	  separators. E.g.,
	  FAN_PROFILE=50:30,80:100

	- Authentication may now work for SECURE=y (although with some issues
	  remaining). Note that authentication can be used with or without TLS,
	  but the latter only works with Chrome/Chromium.

	  See https://almesberger.net/linzhi/AUTH.txt for details.

	- Diagnostics tab with mtr (ping/traceroute), disc (bus presence and
	  length discovery), and ecbt (ECB data integrity test).

	Command-line tools:

	- added mtr (advanced traceroute-type program)

	Bug fixes:

	- crewd could fail with the error "no interface found" (in the log at
	  System > Daemons, crewd) if trying to obtain the IP address at a bad
	  moment, probably during renewal of the DHCP lease.


fw-rd-20210115-1704.tar

	General:

	- If a hashboard signals a CML error, we avoid shutting down if this
	  was the only abnormal condition reported by the voltage regulators.

	Firmware updates:

	- Firmware tar can now include all files needed to create a bootable
	  uSD card. (fw-rd-*-full.tar)

	- A csum*.tar file in the top-level directory of the uSD card is
	  extracted into /mnt/boot/csum/ if it has a more recent version
	  than the existing collection of checksum files.

	Command-line tools:

	- Removed tunecb (obsoleted by fclk)

	- Added tripisl (create fault conditions in an ISL68127)

	Bug fixes:

	- crewd had a race condition that could cause a segfault when starting.

	- mined could crash if trying to send a zero-length hex string to the
	  pool. Note: the cause why it was trying to send a zero-length hex
	  string is still unknown. This fix may thus hide another problem.


fw-rd-20210107-0600.tar

	General:

	- Use the space on uSD cards greater than 16 GB.

	- System > R&D > CID now contains partial decoding of the card ID.

	- If MBIST fails when bringing up a new machine, retry. Report
	  persistent failure as boot problem.

	Firmware releases:

	- Begin deploying new key for evaluation releases.

	- Support firmware packages that contain additional files.

	Crew:

	- ID in JSON export would normally be a number, but for stale entries
	  it became be a string. Now it's always a number.

	Bug fixes:

	- Unpopulated slots caused a false boot warning to be raised and
	  SMBus errors to be reported in System > Problems > Boot problem.

	- In the reporting path, the nonce was passed as 16 bits instead of
	  64. This showed on MQTT in /mine/results and in the Web UI in
	  System > Results, column Nonce. Results sent to the pool were not
	  affected.

	Known bugs:

	- If switching coins, dagd may crash. It may also crash again when
	  restarted.

	  Work-around: delete the content of the DAG cache, directory dag/
	  on the uSD card.

	  Fix: planned for the dagd redesign.


fw-rd-20210102-0409.tar

	General features:

	- Factory reset on Configuration > Reset. Erases the user settings on
	  all EEPROMs in the system (controller and any installed hashboards.)

	- Boot problems may now be reported in System > Problems. They are
	  indicated in the status area ("BOOT"), activate yellow blinking
	  (warning), and are shown in the crew as flag "BOOT".

	Web UI:

	- Cleaned up several JavaScript issues closure-compiler complained
	  about. This should cause no user-visible changes.

	Pool templates:

	- Removed Crazypool/SOLO (closed)

	- Changed Crazypool ETC URL from pps-etc.crazypool.org to
	  etc.crazypool.org

	- Changed F2pool ETH and ETC from wallet.miner to account.miner

	Hardware tuning:

	- Adjust hashboard voltages for better stability (may increase power
	  consumption by ~5 W per board.)

	Bug fixes:

	- Don't show RPC (needed if setting up as NFS client) to the outside
	  world.

	- If the first destination URI attempted by mined specified no coin,
	  mined would segfault.

	Known bugs:

	- (Fixed in fw-rd-20210421-1947)

	  If making changes to the configuration in rapid succession, the
	  miner (the configd process) may fail to receive an update if still
	  processing part of the previous one. This is especially visible on
	  the destination table, which remains in the inactive state if an
	  update is not answered.

	  Work-around: wait at least 5 seconds after the destination has
	  become active before making another change.

	  Work-around: if the destination table is stuck, reload the Web
	  page and repeat the previously attempted change.

	  Fix: planned as part of a comprehensive redesign of the
	  configuration system (required for proper access control.)

	- (Fixed in fw-rd-20210107-0600)

	  If only one slot is populated, errors
	  smbus_read_buffer_pec: Input/output error, addr 0x60, reg 0xAD
	  will be generated when setting up the hashboard. This is reported
	  in System > Problems > Boot problem.

	  Work-around: verify that only "addr 0x60, reg 0xAD" are present
	  in the problem report, then clear the notification and ignore
	  the report.

	  Fix: expected for the next firmware update.


fw-rd-20201228-1906.tar

	General features:

	- Reset counters in System > Problems now only reset when the miner
	  restarts (before, they were zeroed on each page (re)load.)

	- Reset action counters (System > Problems) indicate which type of
	  reset was performed.

	- Added a "quick" reset mode without loading the firmware. This mode
	  is used for most resets, and more costly resets are only performed
	  infrequently.

	- Dark mode: if the configuration variable DARK_TIMEOUT is set to a
	  non-zero number of seconds, all LEDs are turned off after this time
	  if they were showing constant green.

	- After a DCDC shutdown, a register dump is now available under
	  Power > Dump.

	- mined reports the share difficulty requested by the pool on
	  /mine/pool/difficulty. The difficulty is shown in the UI on
	  System > R&D.

	- SerDes speeds of up to 31875 Mbps can now be configured (previous
	  maximum was 28750 Mbps).

	Web UI:

	- Show the destination table as inactive while an update is in
	  progress. This is to discourage changes that would be superseded
	  when the miner returns the updated configuration.

	Pool templates:

	- Added the following ETH pools: 2Miners/SOLO, Beepool, Ethermine,
	  f2pool, FirePool, Hiveon, MiningPoolHub, Nanopool, SpiderPool.

	- Added the following ETC pool: f2pool.

	- Removed the following ETC pools: 1stpool (has no active miners),
	  AntPool (no longer supports ETC), Anyhash.net (no pool at domain).

	- Moved CLO (Callisto) after ETH.

	Crew:

	- The serial numbers of hashboards are now shared with the crew.

	- The wallet/account and rig name of the mining destination are now
	  shared with the crew.

	Bug fixes:

	- DCDC shutdowns were not reported on the Web UI or the crew. This was
	  due to incorrectly set MQTT permissions. The shutdown itself, i.e.,
	  powering down the hashboards, was not affected.

	- SERDES_TRIM was incorrectly processed, producing an invalid
	  connection map that crashed mined.

	- The pool configuration wizard generated incorrect URIs in some
	  cases, e.g., the EU region in 2Miners.com templates.


(previous: fw-rd-20201209-0103.tar)
